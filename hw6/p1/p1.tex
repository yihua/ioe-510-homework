\section{Exercise 6.1 Illustrate local sensitivity analysis}
\textbf{Problem:} Make an original example to illustrate the local-analysis concepts of this chapter.

\textbf{Solution:}  Consider the standard-form problem $(P_{b})$ with $m=3$ and $n=5$

\[
\tag{$P_{b}$}
\begin{array}{ccrrcl}
f(b) & := & \min & c'x  &      &   \\
   &&   &  Ax  &   =  & b~; \\
   &&   &   x  & \geq & \mathbf{0}~,
\end{array}
\]

where
\[
\begin{array}{ccc}
A  :=  \left(
  \begin{array}{ccccc}
    1 & -1 & 0 & -1 & 0  \\
    0 & -4 & 2 & 2 & 0 \\
    0 & -9 & 0 & 6 & 3\\
  \end{array}
\right)~, &
b  :=  (1,2,18)'~,&
c  :=  (16, 7, 20, 10, 4)'~.\\

\end{array}
\]

Consider a fixed basis $\beta = \{1,4,5\}$ for $(P_{b})$. Associated with that basis is the basic solution $\bar{x}_\beta=A^{-1}_\beta b = (2,1,4)'$ and the corresponding dual solution $\bar{y}'= c'_{\beta}A^{-1}_{\beta} = (16,9,4/3)$, which is feasible for the dual of $(P_{b})$. We have

$$f(b) = \bar{y}'b = 16b_1+9b_2+(4/3)b_3,$$

for $b \in \mathcal{B}$ where $\mathcal{B} \subset \mathbb{R}^m$ is the solution set of m linear inequalities (more details below). We have

$$\frac{\partial f}{\partial b_i} = \bar{y}_i,~i=1,...,m.$$

The $\mathcal{B}$ represents that the change to a single right-hand side element $b_i$ should keep $\bar{b}_i > 0$ for $i=1,...,m$. Let the right hand change be $b+\Delta_i{\boldsymbol{e^{i}}}$. Then $A^{-1}_{\beta}(b+\Delta_i{\boldsymbol{e^{i}}}) \geq \mathbf{0}$. Let $h^i := A^{-1}_{\beta}{\boldsymbol{e^{i}}}$. This means that $\Delta_i$ must be in the interval $[L_i, U_i]$, where

$$L_i := \max_{k:h_k^i>0} {-\bar{b}_k/h_k^i}$$, and $$U_i := \min_{k:h_k^i<0} {-\bar{b}_k/h_k^i}$$.

We can confirm through {\tt AMPL} that $\Delta_1 \in [-2,+\infty)$ , $\Delta_2 \in [-2,4]$, and $\Delta_3 \in [-12,+\infty)$ (consistent with Table \ref{tab:p2}).

Next, we define a function $g~:~\mathbb{R}^n \rightarrow \mathbb{R}$ via

\[
\tag{$P^{c}$}
\begin{array}{ccrrcl}
g(c) & := & \min & c'x  &      &   \\
   &&   &  Ax  &   =  & b~; \\
   &&   &   x  & \geq & \mathbf{0}~,
\end{array}
\]

with the same parameters. Consider a fixed basis $\beta = \{1,4,5\}$ for $(P^{c})$. Similarly, we have $g(c) = c_\beta'\bar{x}_\beta = 2c_1+c_4+4c_5$, which is a linear function on $c\in\mathcal{C}$. If only changing a single $c_i$ and the optimal basis keeps, the interval of $c_i$ are: $c_1\in [-23/3,18]$, $c_2\in[-64,+\infty)$, $c_3\in[18, +\infty)$, $c_4\in[-25.5,12]$, and $c_5\in[3,75]$.