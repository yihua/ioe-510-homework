\section{Exercise 7.1 Illustrate decomposition}
\textbf{Problem:} Devise an original example of the decomposition method (see Section 7.1).

\textbf{Solution:} Consider the optimization problem

\[
\tag{$\tilde{P}$}
\begin{array}{ccrrcl}
z & := & \min & \tilde{c}'\tilde{x}  &      &   \\
   &&   &  \tilde{E}\tilde{x}  &\leq & h; \\
   &&   &  \tilde{A}\tilde{x}  &   =  & b~; \\
   &&   &   x  & \geq & \mathbf{0}~,
\end{array}
\]

where
\[
\tilde{E}  :=  \left(
  \begin{array}{cccccc}
   4  &   4  &   2  &  13  &  12  &  13 \\
  \end{array}
\right)~,~
\tilde{A}  :=  \left(
  \begin{array}{cccccc}
      14   &  9  &  13  &   2  &   5  &  12 \\
    15   &  1  &   7  &   7   &  9  &  10 \\
  \end{array}
\right)~,
\]
\[
h  :=  21~,~
b  :=  (27,20)'~,~
\tilde{c}  :=  (5, 4, 8, 2, 10, 3)'~.\\
\]

This problem can be converted into the equivalent standard-form problem $(P)$ 

\[
\tag{$P$}
\begin{array}{ccrrcl}
z & := & \min & c'x  &      &   \\
   &&   &  Ex  & = & h; \\
   &&   &  Ax  &   =  & b~; \\
   &&   &   x  & \geq & \mathbf{0}~,
\end{array}
\]

where

$$ E = [\tilde{E}, \mathbf{I}_1]~,~ A = [\tilde{A}, \mathbf{0}], x = (\tilde{x}~s)', c=(\tilde{c}', 0)'. $$

We show the basic feasible solutions of $S := \{x\in \mathbb{R}^n~:~Ax=b,x\geq\mathbf{0}\}$ in Table \ref{tab:primal-dual}. There is no basic feasible rays of $S$.

\begin{table*}[!h]
\centering
\footnotesize
\begin{tabular}{|c|c|c|}\hline

\textbf{basic partition} & \textbf{primal basic solution} & primal objective\\
& ({\color{green} feasible} or {\color{red} infeasible}) & value $c'x$ \\
\hline\hline
$\eta = (3,4,5,6) $, $\beta = (1,2)$ & {\color{green} $x^1=(1.2645, 1.0331, 0,0,0,0)'$} & 10.4545\\\hline
$\eta = (2,4,5,6) $, $\beta = (1,3)$ & {\color{green}  $x^2=(0.7320, 0, 1.2887,0,0,0,0)'$} & 13.9691\\\hline
$\eta = (2,3,5,6) $, $\beta = (1,4)$ & {\color{red} (2.1912,0,0,-1.8382,0,0)'} & 7.2794\\\hline
$\eta = (2,3,4,6) $, $\beta = (1,5)$ & {\color{red} (2.8039,0,0,0,-2.4510,0)'} & -10.4902\\\hline
$\eta = (2,3,4,5) $, $\beta = (1,6)$ & {\color{red} (-0.7500,0,0,0,0,3.1250)'} & 5.6250\\\hline
$\eta = (1,4,5,6) $, $\beta = (2,3)$ & {\color{red} (0,-1.4200,3.0600,0,0,0)'} & 18.8000\\\hline
$\eta = (1,3,5,6) $, $\beta = (2,4)$ & {\color{green}  $x^3=(0,2.4426,0,2.5082,0,0)'$} & 14.7869\\\hline
$\eta = (1,3,4,6) $, $\beta = (2,5)$ & {\color{green}  $x^4=(0,1.8816,0,0,2.0132,0)'$} & 27.6579\\\hline
\cellcolor{gray!20}$\eta = (1,3,4,5) $, $\beta = (2,6)$ & \cellcolor{gray!20}{\color{green}  $x^5=(0,0.3846,0,0,0,1.9615)'$} & \cellcolor{gray!20}7.4231\\\hline
$\eta = (1,2,5,6) $, $\beta = (3,4)$ & {\color{green} $x^6=(0,0,1.8351,0.9221,0,0)'$} & 17.3247\\\hline
$\eta = (1,2,4,6) $, $\beta = (3,5)$ & {\color{green}  $x^7=(0,0,1.7439,0,0.8659,0)'$} & 22.6098\\\hline
$\eta = (1,2,4,5) $, $\beta = (3,6)$ & {\color{green}  $x^8=(0,0,0.6522,0,0,1.5435)'$} & 9.8478 \\\hline
$\eta = (1,2,3,6) $, $\beta = (4,5)$ & {\color{red} (0,0,0,-8.4118,8.7647,0)'} & 70.8235\\\hline
$\eta = (1,2,3,5) $, $\beta = (4,6)$ & {\color{red} (0,0,0,-0.4687,0,2.3281)'} & 6.0469\\\hline
$\eta = (1,2,3,4) $, $\beta = (5,6)$ & {\color{red} (0,0,0,0,-0.5172,2.4655)'} & 2.2241 \\\hline

\end{tabular}
\caption{Basic partition and primal solutions}
\label{tab:primal-dual}
\end{table*}

Then $(P)$ is equivalen to the Master Problem

\[
\tag{$M$}
\begin{array}{ccrrcl}
z & := & \min & \sum_{j=1}^8 (c'x^j)\lambda_j  &      &   \\
   &&   &  \sum_{j=1}^8 (Ex^j)\lambda_j  & = & h; \\
   &&   &  \sum_{j=1}^8 \lambda_j &   =  & 1~; \\
   &&   &   \lambda_j \geq \mathbf{0}~,j=1,..,8 &&
\end{array}
\]

The extreme point of 

\[
\tag{$P'$}
\begin{array}{ccrrcl}
 & & \min & c'x  &      &   \\
   &&   &  Ax  &   =  & b~; \\
   &&   &   x  & \geq & \mathbf{0}~,
\end{array}
\]

is $x^5=(0,0.3846,0,0,0,1.9615)'$, $c'x^5 = 7.4231$. For initial basis matrix $$B = \left(
  \begin{array}{cc}
     I_1 & Ex^5 \\
    0 & 1\\
  \end{array}
\right)~ =  \left(
  \begin{array}{cc}
     1 & 27.0385 \\
    0 & 1\\
  \end{array}
\right)~$$, the solution is not feasible ($(-6.0385,1)'$). So an artificial variable is needed and a phase-one procedure must be done. After phase one procedure, $$B = \left(
  \begin{array}{cc}
     Ex^5 & Ex^2 \\
    1 & 1\\
  \end{array}
\right)~ =  \left(
  \begin{array}{cc}
      27.0385 & 5.5052 \\
    1 & 1\\
  \end{array}
\right)~$$ ($\lambda_2$ entering the basis).

For the first round, given $B$, the corresponding $\lambda$ is $(0.7196,0.2804)'$. Given the dual solution $\bar{y} = -0.3040, \bar{\sigma} = 15.6426$, solving the (SUB) problem can give a optimal solution $x^1$ for which the optimal objective value is -2.3943, which is eligible to enter the basis of (M). $x^2$ leaves the basis. Now$$B = \left(
  \begin{array}{cc}
     Ex^5 & Ex^1 \\
    1 & 1\\
  \end{array}
\right)~ =  \left(
  \begin{array}{cc}
      27.0385 & 9.1901 \\
    1 & 1\\
  \end{array}
\right)~$$ (the corresponding $\lambda$ is $(0.6617,0.3383)'$).

For the second round, given dual solution  $\bar{y} = -0.1698, \bar{\sigma} = 12.0154$, solving the (SUB) problem can give the optimal objective value 0, which means that no nonbasic $\lambda_j$ is eligible to enter the current basis of (M).

Now we get the optimal solution for (M): $\lambda = (0.3383,0,0,0,0.6617,0,0,0)$. The optimal solution for original problem (P) is $\hat{x} = \lambda_1 x^1 + \lambda_5 x^5 = (0.4278,0.6040,0,0,0,1.2979)'$, and the optimal objective value is 8.4487. This is consistent with the optimal solution giving by {\tt MATLAB}.